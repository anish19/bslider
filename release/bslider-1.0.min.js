(function(){if(__extend_parent__=function(a,b){function c(){this.constructor=a}_.each(_.keys(b),function(c){_.has(b,c)&&(a[c]=b[c])}),c.prototype=b.prototype,a.prototype=new c},"undefined"==typeof Backbone||null===Backbone)throw new Error("This plugin requires the latest version of Backbone. Can be found at http://documentcloud.github.com/backbone/backbone.js");if("undefined"==typeof jQuery)throw new Error("This plugin requires jQuery version 1.10.2 and above. Can be found at http://jquery.com");if("undefined"==typeof $.ui)throw new Error("This plugin requires jQuery-ui version 1.10.3. Can be found at http://jqueryui.com");Backbone.Slider=function(a){function b(){l=this,l.args=Array.prototype.slice.apply(arguments),Backbone.View.prototype.constructor.apply(l,l.args),Backbone.View.prototype.delegateEvents.apply(l,l.args),l.initialize()}function c(){l.navigateLeft=_.wrap(l.navigateLeft,function(a){a(),l.postTransition()}),l.navigateRight=_.wrap(l.navigateRight,function(a){l.preTransition(),a(),l.postTransition()}),l.$(".bslider-nav-left").on("click",l.navigateLeft),l.$(".bslider-nav-right").on("click",l.navigateRight)}function d(){var a=0;l.crossLinksContainer=$("<div />").addClass("cross-links"),l.$el.append(l.crossLinksContainer),l.viewCrossLinkMap={},l.crossLinks=[],_.each(l.views,function(b){var c="bsliderCrossLink"+a++,d=$("<div />").addClass("cross-link").attr("id",c).addClass("unselected");d.text(b.bsliderCrossLinkTitle?b.bsliderCrossLinkTitle:"View "+a),l.crossLinksContainer.append(d),l.crossLinks.push(d),_.extend(l.viewCrossLinkMap,_.object([c],[b]))}),l.$(".cross-link").on("click",l.navigateTo)}function e(a,b,c){$(a.$el).css("display","none"),$(a.$el).insertAfter($(b.$el)),$(b.$el).remove(),l.currentView=_.indexOf(l.views,a),$(a.$el).show("slide",{easing:"easeInOutQuad",direction:c},500,function(){l.currentIndex=_.indexOf(l.views,h()),f()})}function f(){if(l.enableCrossLinks){var a=l.crossLinks[_.indexOf(l.views,h())];_.each(l.crossLinks,function(b){b===a?b.addClass("selected").removeClass("unselected"):b.addClass("unselected").removeClass("selected")})}}function g(a){var b=i(a);b&&(l.currentView=a,l.sliderContainer.append(b.el),f())}function h(){return l.views[l.currentView]}function i(a){return!l.views.length||!l.cycleThrough&&(a>=l.views.length||0>a)?(a>=l.views.length?(l.currentIndex=l.views.length-1,l.currentView=l.currentIndex):0>a&&(l.currentIndex=0,l.currentView=l.currentIndex),void 0):(l.currentIndex=a>=l.views.length?0:0>a?l.views.length-1:a,l.views[l.currentIndex])}function j(){if(!l.views.length)throw new Error("Cannot render the slider. Need at least one view");l.currentView=0,l.sliderContainer.append(i(0).el),f()}function k(a){return null!=a}__extend_parent__(b,a);var l;return b.prototype.className="bslider",b.prototype.events={"click .bslider-nav-left":"navigateLeft","click .bslider-nav-right":"navigateRight"},b.prototype.initialize=function(){if(l.views=l.views||[],l.crossLinkTitles=l.crossLinkTitles||{},l.cycleThrough=l.cycleThrough||!1,l.preTransition=_.isFunction(l.preTransition)?l.preTransition:function(){},l.postTransition=_.isFunction(l.postTransition)?l.postTransition:function(){},_.some(l.views,function(a){return!(a instanceof Backbone.View)}))throw new Error("Cannot initialize slider. Nothing other than backbone views are supported for now");l.currentIndex=-1,l.currentView=-1,c()},b.prototype.addView=function(a){if(!_.isArray(a)||!k(a))throw new Error("Error adding views "+a);_.each(a,function(a){if(!(a instanceof Backbone.View))throw new Error("One of the added views is not a backbone view");l.views.push(a)})},b.prototype.render=function(a){var b=$("<div />").addClass("bslider-nav-container-left");return navContainerRight=$("<div />").addClass("bslider-nav-container-right"),k(a)||(a={}),l.sliderContainer=$("<div></div>").addClass("bslider-container"),l.navLeft=$("<i />").addClass("bslider-nav-left").addClass("icon-circle-arrow-left"),l.navRight=$("<i />").addClass("bslider-nav-right").addClass("icon-circle-arrow-right"),l.$el.html(l.sliderContainer),l.$el.prepend(b.append(l.navLeft)),l.$el.append(navContainerRight.append(l.navRight)),l.enableCrossLinks&&d(),l.initialViewToBeRendered?g(l.initialViewToBeRendered):j(),l},b.prototype.navigateTo=function(a){var b=a.currentTarget.id,c=_.result(l.viewCrossLinkMap,b);if(k(c)){var d=h();l.views.indexOf(c)<l.views.indexOf(d)?e(c,d,"left"):l.views.indexOf(c)>l.views.indexOf(d)&&e(c,d,"right")}},b.prototype.navigateLeft=function(){var a=i(--l.currentIndex);if(k(a)){var b=h();e(a,b,"left")}},b.prototype.navigateRight=function(){var a=i(++l.currentIndex);if(k(a)){var b=h();e(a,b,"right")}},b}(Backbone.View)}).call(this);