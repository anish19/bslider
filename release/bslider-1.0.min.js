(function(){if(__extend_parent__=function(a,b){function c(){this.constructor=a}_.each(_.keys(b),function(c){_.has(b,c)&&(a[c]=b[c])}),c.prototype=b.prototype,a.prototype=new c},"undefined"==typeof Backbone||null===Backbone)throw new Error("This plugin requires the latest version of Backbone. Can be found at http://documentcloud.github.com/backbone/backbone.js");if("undefined"==typeof jQuery)throw new Error("This plugin requires jQuery version 1.10.2 and above. Can be found at http://jquery.com");if("undefined"==typeof $.ui)throw new Error("This plugin requires jQuery-ui version 1.10.3. Can be found at http://jqueryui.com");Backbone.Slider=function(a){function b(){this.args=Array.prototype.slice.apply(arguments),Backbone.View.prototype.constructor.apply(this,this.args),Backbone.View.prototype.delegateEvents.apply(this,this.args),this.initialize()}function c(a){return!(a instanceof Backbone.View)}function d(a){throw new Error(a)}function e(a){return null!=a}return __extend_parent__(b,a),b.prototype.className="bslider",b.prototype.initialize=function(){this.views=this.views||[],this.crossLinkTitles=this.crossLinkTitles||{},this.cycleThrough=this.cycleThrough||!1,this.preTransition=_.isFunction(this.preTransition)?this.preTransition:function(){},this.postTransition=_.isFunction(this.postTransition)?this.postTransition:function(){},_(this.views).some(c)&&d("Cannot initilize slider. Nothing other than backbone views are supported for now"),this.currentIndex=-1,this.currentView=-1},b.prototype.addViews=function(a){var b=this;_.isArray(a)&&e(a)||d("Error adding views "+a),_.each(a,function(a){a instanceof Backbone.View||d("One of the added views is not a backbone view"),b.views.push(a)})},b.prototype.setupEventHandlers=function(){var a=this;this.navigateLeft=_.wrap(this.navigateLeft,function(b){a.preTransition(),b(a),a.postTransition()}),this.navigateRight=_.wrap(this.navigateRight,function(b){a.preTransition(),b(a),a.postTransition()}),this.$(".bslider-nav-left").on("click",this.navigateLeft),this.$(".bslider-nav-right").on("click",this.navigateRight)},b.prototype.render=function(a){var b=$("<div />").addClass("bslider-nav-container-left");return navContainerRight=$("<div />").addClass("bslider-nav-container-right"),e(a)||(a={}),this.sliderContainer=$("<div></div>").addClass("bslider-container"),this.navLeft=$("<i />").addClass("bslider-nav-left").addClass("icon-circle-arrow-left"),this.navRight=$("<i />").addClass("bslider-nav-right").addClass("icon-circle-arrow-right"),this.$el.html(this.sliderContainer),this.$el.prepend(b.append(this.navLeft)),this.$el.append(navContainerRight.append(this.navRight)),this.enableCrossLinks&&this.createCrossLinks(),this.initialViewToBeRendered?this.renderViewAt(this.initialViewToBeRendered):this.renderFirstView(),this.setupEventHandlers(),this},b.prototype.createCrossLinks=function(){var a=this;this.crossLinkCount=0,this.crossLinksContainer=$("<div />").addClass("cross-links"),this.$el.append(this.crossLinksContainer),this.viewCrossLinkMap={},this.crossLinks=[],_(this.views).each(this.createCrossLink,this),this.$(".cross-link").on("click",function(b){a.navigateTo(b)})},b.prototype.createCrossLink=function(a){var b="bsliderCrossLink"+this.crossLinkCount++,c=$("<div />").addClass("cross-link").attr("id",b).addClass("unselected");c.text(a.bsliderCrossLinkTitle?a.bsliderCrossLinkTitle:"View "+this.crossLinkCount),this.crossLinksContainer.append(c),this.crossLinks.push(c),_.extend(this.viewCrossLinkMap,_.object([b],[a]))},b.prototype.navigateTo=function(a){var b=a.currentTarget.id,c=_.result(this.viewCrossLinkMap,b);if(e(c)){var d=this.getCurrentView();this.views.indexOf(c)<this.views.indexOf(d)?this.renderNewAndRemoveOld(c,d,"left"):this.views.indexOf(c)>this.views.indexOf(d)&&this.renderNewAndRemoveOld(c,d,"right")}},b.prototype.renderNewAndRemoveOld=function(a,b,c){var d="left"===c?"right":"left",e=this;$(a.$el).css("display","none"),$(a.$el).insertAfter($(b.$el)),$(a.$el).addClass("top-most"),$(b.$el).addClass("bottom-most"),$(b.$el).hide("slide",{easing:"easeInOutQuad",direction:d,queue:!1},500,function(){$(b.$el).removeClass("bottom-most"),$(b.$el).remove()}),this.currentView=_.indexOf(this.views,a),$(a.$el).show("slide",{easing:"easeInOutQuad",direction:c,queue:!1},500,function(){$(a.$el).removeClass("top-most"),e.currentIndex=_.indexOf(e.views,e.getCurrentView()),e.updateCrossLinks(e)})},b.prototype.updateCrossLinks=function(){if(this.enableCrossLinks){var a=this.crossLinks[_.indexOf(this.views,this.getCurrentView())];_.each(this.crossLinks,function(b){b===a?b.addClass("selected").removeClass("unselected"):b.addClass("unselected").removeClass("selected")})}},b.prototype.navigateLeft=function(a){var b=a.getViewAt(--a.currentIndex);if(e(b)){var c=a.getCurrentView();a.renderNewAndRemoveOld(b,c,"left")}},b.prototype.navigateRight=function(a){var b=a.getViewAt(++a.currentIndex);if(e(b)){var c=a.getCurrentView();a.renderNewAndRemoveOld(b,c,"right")}},b.prototype.renderViewAt=function(a){var b=this.getViewAt(a);b&&(this.currentView=a,this.sliderContainer.append(b.el),this.updateCrossLinks(this))},b.prototype.getCurrentView=function(){return this.views[this.currentView]},b.prototype.getViewAt=function(a){return!this.views.length||!this.cycleThrough&&(a>=this.views.length||0>a)?(a>=this.views.length?(this.currentIndex=this.views.length-1,this.currentView=this.currentIndex):0>a&&(this.currentIndex=0,this.currentView=this.currentIndex),void 0):(this.currentIndex=a>=this.views.length?0:0>a?this.views.length-1:a,this.views[this.currentIndex])},b.prototype.renderFirstView=function(){this.views.length||d("Cannot render the slider. Need at least one view"),this.currentView=0,this.sliderContainer.append(this.getViewAt(0).el),this.updateCrossLinks(this)},b}(Backbone.View)}).call(this);